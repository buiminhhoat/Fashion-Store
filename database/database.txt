DROP DATABASE IF EXISTS fashionstore;

CREATE DATABASE fashionstore;

USE fashionstore;

-- Tạo bảng Users
CREATE TABLE IF NOT EXISTS Users (
    UserID BIGINT PRIMARY KEY AUTO_INCREMENT,
    FullName VARCHAR(255) NOT NULL,
    Email VARCHAR(255) UNIQUE NOT NULL,
    PhoneNumber VARCHAR(20),
    Gender VARCHAR(10),
    DateBirthday DATE,
    AvatarPath VARCHAR(255),
	IsAdmin BOOLEAN
);

-- Tạo bảng Address
CREATE TABLE IF NOT EXISTS Address (
    AddressID BIGINT PRIMARY KEY AUTO_INCREMENT,
    UserID BIGINT,
    RecipientName VARCHAR(255) NOT NULL,
    RecipientPhone VARCHAR(20),
    AddressDetails VARCHAR(255),
    FOREIGN KEY (UserID) REFERENCES Users(UserID)
);

-- Tạo bảng Orders
CREATE TABLE IF NOT EXISTS Orders (
    OrderID INT PRIMARY KEY AUTO_INCREMENT,
    OrderDate DATE,
    TotalAmount DECIMAL(10, 2),
    OrderStatus VARCHAR(20),
    UserID BIGINT,
    FOREIGN KEY (UserID) REFERENCES Users(UserID)
);

-- Tạo bảng Product
CREATE TABLE IF NOT EXISTS Product (
    ProductID BIGINT PRIMARY KEY AUTO_INCREMENT,
    ProductName VARCHAR(255) NOT NULL,
    ProductPrice DECIMAL(10, 2),
    ProductDescription TEXT
);

-- Tạo bảng OrderDetail
CREATE TABLE IF NOT EXISTS OrderDetail (
    OrderDetailID INT PRIMARY KEY AUTO_INCREMENT,
    OrderID INT,
    ProductID BIGINT,
    ProductPrice DECIMAL(10, 2),
    Quantity BIGINT,
    TotalPrice DECIMAL(10, 2),
    FOREIGN KEY (OrderID) REFERENCES Orders(OrderID),
    FOREIGN KEY (ProductID) REFERENCES Product(ProductID)
);

-- Tạo bảng ProductSize
CREATE TABLE IF NOT EXISTS ProductSize (
    SizeID BIGINT PRIMARY KEY AUTO_INCREMENT,
    ProductID BIGINT,
    SizeName VARCHAR(20),
    FOREIGN KEY (ProductID) REFERENCES Product(ProductID)
);

-- Tạo bảng ProductImage
CREATE TABLE IF NOT EXISTS ProductImage (
    ImageID BIGINT PRIMARY KEY AUTO_INCREMENT,
    ProductID BIGINT,
    ImagePath VARCHAR(255),
    FOREIGN KEY (ProductID) REFERENCES Product(ProductID)
);

-- Tạo bảng ProductQuantity
CREATE TABLE IF NOT EXISTS ProductQuantity (
    QuantityID BIGINT PRIMARY KEY AUTO_INCREMENT,
    ProductID BIGINT,
	SizeID BIGINT,
    Quantity BIGINT,
    FOREIGN KEY (ProductID) REFERENCES Product(ProductID),
    FOREIGN KEY (SizeID) REFERENCES ProductSize(SizeID)
);

-- Tạo bảng Category
CREATE TABLE IF NOT EXISTS Category (
    CategoryID BIGINT PRIMARY KEY AUTO_INCREMENT,
    CategoryName VARCHAR(255) NOT NULL,
    ParentCategoryID BIGINT,
    FOREIGN KEY (ParentCategoryID) REFERENCES Category(CategoryID)
);

-- Tạo bảng ProductCategory
CREATE TABLE IF NOT EXISTS ProductCategory (
    ProductCategoryID BIGINT PRIMARY KEY AUTO_INCREMENT,
    ProductID BIGINT,
    CategoryID BIGINT,
	ParentCategoryID BIGINT,
    FOREIGN KEY (ProductID) REFERENCES Product(ProductID),
    FOREIGN KEY (CategoryID) REFERENCES Category(CategoryID),
    FOREIGN KEY (ParentCategoryID) REFERENCES Category(ParentCategoryID)
);

-- Tạo bảng Cart
CREATE TABLE IF NOT EXISTS Cart (
    CartID BIGINT PRIMARY KEY AUTO_INCREMENT,
    UserID BIGINT,
    CreatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (UserID) REFERENCES Users(UserID)
);

-- Tạo bảng CartItem
CREATE TABLE IF NOT EXISTS CartItem (
    CartItemID BIGINT PRIMARY KEY AUTO_INCREMENT,
    CartID BIGINT,
	ProductID BIGINT,
    SizeID BIGINT,
    Quantity BIGINT,
    FOREIGN KEY (CartID) REFERENCES Cart(CartID),
	FOREIGN KEY (ProductID) REFERENCES Product(ProductID),
    FOREIGN KEY (SizeID) REFERENCES ProductSize(SizeID)
);

